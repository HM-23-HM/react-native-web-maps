{"version":3,"names":["Location","_interopRequireWildcard","require","_react","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","useUserLocation","options","location","setLocation","useState","watchPositionSubscription","setWatchPositionSubscription","permission","useForegroundPermissions","request","requestPermission","showUserLocation","handleLocationChange","useCallback","_options$onUserLocati","onUserLocationChange","nativeEvent","coordinate","coords","timestamp","Date","now","altitude","heading","accuracy","Accuracy","Balanced","isFromMockProvider","mocked","speed","useEffect","granted","followUserLocation","getCurrentPositionAsync","then","watchPositionAsync","remove"],"sources":["use-user-location.tsx"],"sourcesContent":["import * as Location from 'expo-location';\nimport { useCallback, useEffect, useState } from 'react';\nimport type { UserLocationChangeEvent } from 'react-native-maps';\n\ninterface UseUserLocationOptions {\n  requestPermission: boolean;\n  onUserLocationChange?(e: UserLocationChangeEvent): void;\n  followUserLocation: boolean;\n  showUserLocation: boolean;\n}\n\nexport function useUserLocation(options: UseUserLocationOptions) {\n  const [location, setLocation] = useState<Location.LocationObject>();\n\n  const [watchPositionSubscription, setWatchPositionSubscription] =\n    useState<Location.LocationSubscription>();\n\n  const [permission] = Location.useForegroundPermissions({\n    request: options.requestPermission,\n    get: options.showUserLocation,\n  });\n\n  const handleLocationChange = useCallback(\n    function (e: Location.LocationObject) {\n      setLocation(e);\n      options.onUserLocationChange?.({\n        nativeEvent: {\n          coordinate: {\n            ...e.coords,\n            timestamp: Date.now(),\n            altitude: e.coords.altitude || 0,\n            heading: e.coords.heading || 0,\n            accuracy: e.coords.accuracy || Location.Accuracy.Balanced,\n            isFromMockProvider: e.mocked || false,\n            speed: e.coords.speed || 0,\n          },\n        },\n      } as unknown as UserLocationChangeEvent);\n    },\n    [options.onUserLocationChange]\n  );\n\n  useEffect(() => {\n    if (permission?.granted && options.followUserLocation) {\n      Location.getCurrentPositionAsync().then(handleLocationChange);\n      // Watch position\n      Location.watchPositionAsync(\n        { accuracy: Location.Accuracy.Balanced },\n        handleLocationChange\n      ).then(setWatchPositionSubscription);\n    }\n\n    return () => watchPositionSubscription?.remove();\n  }, [permission, options.followUserLocation]);\n\n  return location;\n}\n"],"mappings":"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","ignoreList":[]}