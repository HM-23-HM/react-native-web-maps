{"version":3,"names":["_react","_interopRequireDefault","require","_api","_mouseEvent","_callout","e","__esModule","default","_extends","Object","assign","bind","n","arguments","length","t","r","hasOwnProperty","call","apply","Marker","React","Component","constructor","props","state","calloutVisible","showCallout","setState","hideCallout","render","createElement","MarkerF","toggleCalloutVisible","exports","_props$anchor","_props$anchor2","map","useGoogleMap","customMarkerContainerRef","useRef","markerSize","setMarkerSize","useState","width","height","useEffect","current","clientWidth","clientHeight","onMarkerPress","_props$onPress","onPress","mapMouseEventToMapEvent","coordinate","hasNonCalloutChildren","useMemo","Children","toArray","children","find","child","type","Callout","anchor","x","y","calloutAnchor","calloutContextValue","CalloutContext","Provider","value","Fragment","OverlayViewF","mapPaneName","position","lat","Number","latitude","lng","longitude","getPixelPositionOffset","w","h","ref","onClick","draggable","title","onDrag","_props$onDrag","onDragStart","_props$onDragStart","onDragEnd","_props$onDragEnd","options","clickable","tappable","opacity","anchorPoint","google","maps","Point"],"sources":["marker.web.tsx"],"sourcesContent":["import React from 'react';\nimport type { ReactElement, Ref } from 'react';\nimport {\n  Marker as GMMarker,\n  OverlayViewF as GMOverlayView,\n  useGoogleMap,\n} from '@react-google-maps/api';\nimport type { MapMarkerProps, Point } from 'react-native-maps';\nimport { mapMouseEventToMapEvent } from '../utils/mouse-event';\nimport { Callout, CalloutContext } from './callout';\nimport type { CalloutContextType } from './callout';\n\ninterface MarkerState {\n  calloutVisible: boolean;\n}\n\n//Wrapped in class component to provide methods\n//forwardRef + useImperativeHandle not sufficient because it returns a ForwardRefExoticComponent which does not seem to render in the MapView\nexport class Marker extends React.Component<MapMarkerProps, MarkerState> {\n  constructor(props: MapMarkerProps) {\n    super(props);\n    this.state = { calloutVisible: false };\n  }\n\n  showCallout() {\n    this.setState({ calloutVisible: true });\n  }\n\n  hideCallout() {\n    this.setState({ calloutVisible: false });\n  }\n\n  render(): React.ReactNode {\n    return (\n      <MarkerF\n        {...this.props}\n        calloutVisible={this.state.calloutVisible}\n        toggleCalloutVisible={() =>\n          this.setState({ calloutVisible: !this.state.calloutVisible })\n        }\n      />\n    );\n  }\n}\n\ninterface MarkerFProps extends MapMarkerProps {\n  calloutVisible: boolean;\n  toggleCalloutVisible: () => void;\n}\n\nfunction MarkerF(props: MarkerFProps) {\n  const map = useGoogleMap();\n\n  const customMarkerContainerRef = React.useRef<HTMLDivElement>();\n  const [markerSize, setMarkerSize] = React.useState<{\n    width: number;\n    height: number;\n  }>({ width: 22, height: 40 }); //22 x 40 is the default google maps marker size\n\n  React.useEffect(() => {\n    if (customMarkerContainerRef.current) {\n      setMarkerSize({\n        width: customMarkerContainerRef.current.clientWidth,\n        height: customMarkerContainerRef.current.clientHeight,\n      });\n    }\n  }, [customMarkerContainerRef.current]);\n\n  const onMarkerPress = (e?: google.maps.MapMouseEvent) => {\n    props.onPress?.(\n      mapMouseEventToMapEvent(e, props.coordinate, map, 'marker-press')\n    );\n    props.toggleCalloutVisible();\n  };\n\n  const hasNonCalloutChildren = React.useMemo(\n    () =>\n      !!React.Children.toArray(props.children).find((child) => {\n        return (child as ReactElement).type !== Callout;\n      }),\n    [props.children]\n  );\n\n  //Default anchor values to react-native-maps values (https://github.com/react-native-maps/react-native-maps/blob/master/docs/marker.md)\n  const anchor: Point = props.anchor || { x: 0.5, y: 1 };\n  const calloutAnchor: Point = props.calloutAnchor || { x: 0.5, y: 0 };\n\n  const calloutContextValue: CalloutContextType = {\n    calloutVisible: props.calloutVisible,\n    toggleCalloutVisible: props.toggleCalloutVisible,\n    coordinate: props.coordinate,\n    markerSize,\n    anchor: calloutAnchor,\n  };\n\n  return (\n    <CalloutContext.Provider value={calloutContextValue}>\n      <>\n        {hasNonCalloutChildren ? (\n          <GMOverlayView\n            mapPaneName=\"overlayMouseTarget\"\n            position={{\n              lat: Number(props.coordinate.latitude),\n              lng: Number(props.coordinate.longitude),\n            }}\n            getPixelPositionOffset={(w, h) => ({\n              x: -(w * anchor!.x),\n              y: -(h * anchor!.y),\n            })}\n          >\n            <div\n              ref={customMarkerContainerRef as Ref<HTMLDivElement>}\n              onClick={() => onMarkerPress()}\n            >\n              {props.children}\n            </div>\n          </GMOverlayView>\n        ) : (\n          <GMMarker\n            draggable={props.draggable}\n            title={props.title}\n            onClick={(e) => onMarkerPress(e)}\n            onDrag={(e) =>\n              props.onDrag?.(\n                mapMouseEventToMapEvent(e, props.coordinate, map, '')\n              )\n            }\n            onDragStart={(e) =>\n              props.onDragStart?.(\n                mapMouseEventToMapEvent(e, props.coordinate, map, '')\n              )\n            }\n            onDragEnd={(e) =>\n              props.onDragEnd?.(\n                mapMouseEventToMapEvent(e, props.coordinate, map, '')\n              )\n            }\n            options={{\n              clickable: props.tappable,\n              opacity: props.opacity,\n              draggable: props.draggable,\n              anchorPoint: props.anchor\n                ? new google.maps.Point(props.anchor?.x, props.anchor?.y)\n                : null,\n            }}\n            position={{\n              lat: Number(props.coordinate.latitude),\n              lng: Number(props.coordinate.longitude),\n            }}\n            children={props.children}\n          />\n        )}\n      </>\n    </CalloutContext.Provider>\n  );\n}\n"],"mappings":"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","ignoreList":[]}