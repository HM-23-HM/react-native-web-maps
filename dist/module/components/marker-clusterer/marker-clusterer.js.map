{"version":3,"names":["React","memo","useMemo","useState","getBoundByRegion","Cluster","Supercluster","Marker","_MarkerClusterer","props","supercluster","_setSupercluster","markers","Children","toArray","children","filter","child","type","points","map","node","properties","cluster","geometry","coordinates","Number","coordinate","longitude","latitude","clusters","region","bbox","load","getClusters","Math","round","log","longitudeDelta","LN2","createElement","Fragment","feature","idx","_props$renderCluster","clusterProperties","clusterProps","expansionZoom","getClusterExpansionZoom","cluster_id","pointCount","point_count","pointCountAbbreviated","point_count_abbreviated","key","toString","renderCluster","call","MarkerClusterer"],"sources":["marker-clusterer.js"],"sourcesContent":["import React, { memo, useMemo, useState } from 'react';\nimport { getBoundByRegion } from '../../utils/region';\nimport { Cluster } from './cluster';\nimport Supercluster from 'supercluster';\nimport { Marker } from '../marker';\nfunction _MarkerClusterer(props) {\n  const [supercluster, _setSupercluster] = useState(new Supercluster());\n  const markers = useMemo(\n    () =>\n      React.Children.toArray(props.children).filter((child) => {\n        return child.type === Marker;\n      }) || [],\n    [props.children]\n  );\n  const points = useMemo(\n    () =>\n      markers.map((node) => ({\n        type: 'Feature',\n        properties: { cluster: false, node },\n        geometry: {\n          type: 'Point',\n          coordinates: [\n            Number(node.props.coordinate.longitude),\n            Number(node.props.coordinate.latitude),\n          ],\n        },\n      })),\n    [markers]\n  );\n  const clusters = useMemo(() => {\n    if (!props.region) return [];\n    const bbox = getBoundByRegion(props.region);\n    supercluster.load(points);\n    return supercluster.getClusters(\n      bbox,\n      Math.round(Math.log(360 / props.region.longitudeDelta) / Math.LN2)\n    );\n  }, [props.region, points]);\n  return React.createElement(\n    React.Fragment,\n    null,\n    clusters.map((feature, idx) => {\n      const clusterProperties = feature.properties;\n      const clusterProps = {\n        expansionZoom: supercluster.getClusterExpansionZoom(\n          clusterProperties.cluster_id\n        ),\n        pointCount: clusterProperties.point_count,\n        pointCountAbbreviated: clusterProperties.point_count_abbreviated,\n        coordinate: {\n          longitude: feature.geometry.coordinates[0],\n          latitude: feature.geometry.coordinates[1],\n        },\n      };\n      return React.createElement(\n        React.Fragment,\n        { key: idx.toString() },\n        feature.properties.cluster === true\n          ? props.renderCluster?.(clusterProps) ||\n              React.createElement(Cluster, { ...clusterProps })\n          : feature.properties.node\n      );\n    })\n  );\n}\nexport const MarkerClusterer = memo(_MarkerClusterer);\n"],"mappings":"AAAA,OAAOA,KAAK,IAAIC,IAAI,EAAEC,OAAO,EAAEC,QAAQ,QAAQ,OAAO;AACtD,SAASC,gBAAgB,QAAQ,oBAAoB;AACrD,SAASC,OAAO,QAAQ,WAAW;AACnC,OAAOC,YAAY,MAAM,cAAc;AACvC,SAASC,MAAM,QAAQ,WAAW;AAClC,SAASC,gBAAgBA,CAACC,KAAK,EAAE;EAC/B,MAAM,CAACC,YAAY,EAAEC,gBAAgB,CAAC,GAAGR,QAAQ,CAAC,IAAIG,YAAY,CAAC,CAAC,CAAC;EACrE,MAAMM,OAAO,GAAGV,OAAO,CACrB,MACEF,KAAK,CAACa,QAAQ,CAACC,OAAO,CAACL,KAAK,CAACM,QAAQ,CAAC,CAACC,MAAM,CAAEC,KAAK,IAAK;IACvD,OAAOA,KAAK,CAACC,IAAI,KAAKX,MAAM;EAC9B,CAAC,CAAC,IAAI,EAAE,EACV,CAACE,KAAK,CAACM,QAAQ,CACjB,CAAC;EACD,MAAMI,MAAM,GAAGjB,OAAO,CACpB,MACEU,OAAO,CAACQ,GAAG,CAAEC,IAAI,KAAM;IACrBH,IAAI,EAAE,SAAS;IACfI,UAAU,EAAE;MAAEC,OAAO,EAAE,KAAK;MAAEF;IAAK,CAAC;IACpCG,QAAQ,EAAE;MACRN,IAAI,EAAE,OAAO;MACbO,WAAW,EAAE,CACXC,MAAM,CAACL,IAAI,CAACZ,KAAK,CAACkB,UAAU,CAACC,SAAS,CAAC,EACvCF,MAAM,CAACL,IAAI,CAACZ,KAAK,CAACkB,UAAU,CAACE,QAAQ,CAAC;IAE1C;EACF,CAAC,CAAC,CAAC,EACL,CAACjB,OAAO,CACV,CAAC;EACD,MAAMkB,QAAQ,GAAG5B,OAAO,CAAC,MAAM;IAC7B,IAAI,CAACO,KAAK,CAACsB,MAAM,EAAE,OAAO,EAAE;IAC5B,MAAMC,IAAI,GAAG5B,gBAAgB,CAACK,KAAK,CAACsB,MAAM,CAAC;IAC3CrB,YAAY,CAACuB,IAAI,CAACd,MAAM,CAAC;IACzB,OAAOT,YAAY,CAACwB,WAAW,CAC7BF,IAAI,EACJG,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,GAAG,CAAC,GAAG,GAAG5B,KAAK,CAACsB,MAAM,CAACO,cAAc,CAAC,GAAGH,IAAI,CAACI,GAAG,CACnE,CAAC;EACH,CAAC,EAAE,CAAC9B,KAAK,CAACsB,MAAM,EAAEZ,MAAM,CAAC,CAAC;EAC1B,oBAAOnB,KAAK,CAACwC,aAAa,CACxBxC,KAAK,CAACyC,QAAQ,EACd,IAAI,EACJX,QAAQ,CAACV,GAAG,CAAC,CAACsB,OAAO,EAAEC,GAAG,KAAK;IAAA,IAAAC,oBAAA;IAC7B,MAAMC,iBAAiB,GAAGH,OAAO,CAACpB,UAAU;IAC5C,MAAMwB,YAAY,GAAG;MACnBC,aAAa,EAAErC,YAAY,CAACsC,uBAAuB,CACjDH,iBAAiB,CAACI,UACpB,CAAC;MACDC,UAAU,EAAEL,iBAAiB,CAACM,WAAW;MACzCC,qBAAqB,EAAEP,iBAAiB,CAACQ,uBAAuB;MAChE1B,UAAU,EAAE;QACVC,SAAS,EAAEc,OAAO,CAAClB,QAAQ,CAACC,WAAW,CAAC,CAAC,CAAC;QAC1CI,QAAQ,EAAEa,OAAO,CAAClB,QAAQ,CAACC,WAAW,CAAC,CAAC;MAC1C;IACF,CAAC;IACD,oBAAOzB,KAAK,CAACwC,aAAa,CACxBxC,KAAK,CAACyC,QAAQ,EACd;MAAEa,GAAG,EAAEX,GAAG,CAACY,QAAQ,CAAC;IAAE,CAAC,EACvBb,OAAO,CAACpB,UAAU,CAACC,OAAO,KAAK,IAAI,GAC/B,EAAAqB,oBAAA,GAAAnC,KAAK,CAAC+C,aAAa,cAAAZ,oBAAA,uBAAnBA,oBAAA,CAAAa,IAAA,CAAAhD,KAAK,EAAiBqC,YAAY,CAAC,kBACjC9C,KAAK,CAACwC,aAAa,CAACnC,OAAO,EAAE;MAAE,GAAGyC;IAAa,CAAC,CAAC,GACnDJ,OAAO,CAACpB,UAAU,CAACD,IACzB,CAAC;EACH,CAAC,CACH,CAAC;AACH;AACA,OAAO,MAAMqC,eAAe,gBAAGzD,IAAI,CAACO,gBAAgB,CAAC","ignoreList":[]}